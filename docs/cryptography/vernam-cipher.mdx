---
title: Vernam cipher
slug: /cryptography/vernam-cipher
---

## Introduction

The Vernam Cipher is a method of encrypting a plaintext message. In theory, it is a perfect cipher. Here, there is no concept of a single key. Each character of the plaintext is encrypted using its own key.

## Explanation

The length of the key used to encrypt a message is exactly equal to the length of the message. Each character of the ciphertext is generated by padding each character of the plaintext with each character of the key. The characters of plaintext and key are first converted to numbers. `A` to `0`, `B` to `1`, . . . . , and `Z` to `25`. Now they are added character by character to form the ciphertext.

Let us have one example:

```
Plaintext: testcase
Here, length of the plaintext message is 8. So, the key to be used must also be of length 8.

Key: mercurie
The length of the key is equal to the length of the plaintext.

t e s t c a s e : 19 4 18 19  2  0  18 4
m e r c u r i e : 12 4 17 2  20 17   8 4

ciphertext      : 31 8 35 21 22 17  26 8

Since our numbering is from [0-25] we take mod 26 to ensure that everything remains within this
range.

ciphertext      : 5 8 9 21 22 17 0 8
ciphertext      : f i j  v  w  r a i
```

## Algorithm

#### Encryption

```
Convert the characters of the plaintext and the key to numbers. The numbers are assigned
alphabetically. A-Z : 0-25.

Add the numbers present at the same index. Take mod 26 to ensure that the numbers stay within the
range [0-25].

Now convert the numbers back to ASCII in the same manner to get the ciphertext. (0-25 : A-Z)

Ciphertext at index i is given by,
Ciphertext(i) = [Plaintext(i) + Key(i)] % 26
```

#### Decryption

```
Convert the characters of the ciphertext and the key to numbers. The numbers are assigned
alphabetically. A-Z : 0-25.

Subtract the numbers present at the same index. Take mod 26 to ensure that the numbers stay within
the range [0-25].

Now convert the numbers back to ASCII in the same manner to get the underlying plaintext.

Plaintext at index i is given by,
Plaintext(i) = [Ciphertext(i) - Key(i)] % 26
```

## Code

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs
  defaultValue="cpp"
  values={[
    { label: 'C++', value: 'cpp', },
    { label: 'Python', value: 'py', },
  ]
}>

<TabItem value="cpp">

```cpp
#include<bits/stdc++.h>
using namespace std;

string encrypt(string plain,string key) {
	string enc="";
	int n=key.length();
	for(int i=0;i<n;i++) {
		int y = plain[i]+key[i]-194;
		if(y>=26) {
			y = y-26;
		}
		enc+=char(y+97);
	}
	return enc;
}

string decrypt(string enc,string key) {
	string dec="";
	int n=enc.length();
	for(int i=0;i<n;i++) {
		if(enc[i]>=key[i]) {
			dec+=char(enc[i]-key[i]+97);
		}
		else {
			dec+=char(enc[i]-key[i]+123);  
		}
	}
	return dec;
}

int main() {
	cout<<"1. Encrypt a plaintext"<<endl;
	cout<<"2. Decrypt a ciphertext"<<endl;
	cout<<"3. Exit"<<endl;

	int choice;
	cout << "Enter your choice: ";
	cin >> choice;

	if(choice == 3) {
		cout<<"\nExiting program."<<endl;
		exit(0);
	}
	else if(choice == 1) {
		string plain, key;
		cout<<"Plaintext and key must be of same length."<<endl;
		cout<<"Enter a message you want to encrypt: ";
		cin >> plain;

		cout<<"Enter a key to encrypt the message: ";
		cin >> key;

		if(plain.length() != key.length()) {
			cout << "\nPlease enter a valid input."<<endl;
			exit(0);
		}

		transform(key.begin(), key.end(), key.begin(), ::tolower);
		transform(plain.begin(), plain.end(), plain.begin(), ::tolower);

		string encrypted = encrypt(plain, key);
		cout<<"\nEncrypted message is: "<<encrypted<<endl;
	}
	else if(choice == 2) {
		string ciphertext, key;
		cout<<"Enter a ciphertext you want to decrypt: ";
		cin >> ciphertext;

		cout<<"Enter a key to decrypt the ciphertext: ";
		cin >> key;

		if(ciphertext.length() != key.length()) {
			cout<<"\nPlease enter a valid input."<<endl;
			exit(0);
		}

		transform(key.begin(), key.end(), key.begin(), ::tolower);
		transform(ciphertext.begin(), ciphertext.end(), ciphertext.begin(), ::tolower);

		string decrypted = decrypt(ciphertext, key);
		cout<<"\nDecrypted message is: "<<decrypted<<endl;
		exit(0);
	}
	else {
		cout<<"\nInvalid choice."<<endl;
		exit(0);
	}
}
```

</TabItem>
<TabItem value="py">

```python
import sys

'''This function assigns a number from 
   [0-25] to characters [a-z] respectively.'''

def ascii_to_dec(text): 
    ascii_text = []
    text = text.lower()
    for i in text:
        ascii_text.append(ord(i) - 97)
    return ascii_text


'''This is the encryption function which takes plaintext 
   and keyword as input. It then converts both plaintext 
   and keyword to a number. Adds them. Take %26 to form 
   the corresponding ciphertext.'''

def encryption(message, keyword):
    pad = ascii_to_dec(keyword)
    mess = ascii_to_dec(message)
    enc = []
    for i in range(len(message)):
        character = chr(((mess[i] + pad[i]) % 26) + 97)
        if message[i].islower():
            enc.append(character)
        else:
            enc.append(character.upper())
    return ''.join(enc)

'''This is the decryption function which takes ciphertext
   and keyword as input. It then converts both ciphertext
   and keyword to a number. Subtracts them. Takes %26 to 
   form the corresponding plaintext'''

def decryption(ciphertext, keyword):
    pad = ascii_to_dec(keyword)
    cipher = ascii_to_dec(ciphertext)
    dec = []
    for i in range(len(ciphertext)):
        character = chr(((cipher[i] - pad[i]) % 26) + 97)
        if ciphertext[i].islower():
            dec.append(character)
        else:
            dec.append(character.upper())
    return ''.join(dec)

# Driver function
if __name__=='__main__':

    print("1. Encrypt a plaintext")
    print("2. Decrypt a ciphertext")
    print("3. Exit")

    # Taking choice from user
    choice = int(input("Enter your choice: "))

    if(choice == 3):
        print("\nExiting program.")
        sys.exit(0)

    # If the user chooses to encrypt a message
    elif(choice == 1):

        # Take plaintext and keyword as input
        print("Plaintext and key must be of same length.")
        plaintext = input("Enter a message you want to encrypt: ")
        key = input("Enter a key to encrypt the message: ")
        
        # Check if the length of keyword is same as plaintext or not
        if(len(plaintext) != len(key)):
            print("\nPlease enter a valid input.")
            sys.exit(0)

        # Call the encrpytion function to encrypt the text
        encrypted_message = encryption(plaintext.lower(), key.lower())

        # Print the encrypted message
        print("\nEncrypted message is:", encrypted_message)

    # If the user chooses to decrypt a ciphertext
    elif(choice == 2):

        # Take ciphertext and keyword as input
        print("Ciphertext and key must be of same length.")
        ciphertext = input("Enter a ciphertext you want to decrypt: ")
        key = input("Enter a key to decrypt the ciphertext: ")

        # Check if length of keyword is equal to ciphertext or not
        if(len(ciphertext) != len(key)):
            print("\nPlease enter a valid input.")
            sys.exit(0)

        # Call the decryption function to decrypt the ciphertext
        decrypted_message = decryption(ciphertext.lower(), key.lower())

        # Print the decrypted ciphertext
        print("\nDecrypted message is:", decrypted_message)

    # If an invalid input is provided
    else:
        print("\nInvalid choice.")
```

</TabItem>
</Tabs>

## Sample Input and Output

#### Input

```
1. Encrypt a plaintext
2. Decrypt a ciphertext
3. Exit
Enter your choice: 1
Plaintext and key must be of same length.
Enter a message you want to encrypt: testcase
Enter a key to encrypt the message: mercurie
```

#### Output

```
Encrypted message is: fijvwrai
```

#### Input

```
1. Encrypt a plaintext
2. Decrypt a ciphertext
3. Exit
Enter your choice: 2
Ciphertext and key must be of same length.
Enter a ciphertext you want to decrypt: fijvwrai
Enter a key to decrypt the ciphertext: mercurie
```

#### Output

```
Decrypted message is: testcase
```

## Complexity Analysis

  - Time complexity : `O(n)`
  - Space complexity: `O(n)`

## Credits

  - [Sidhant-Gupta](https://github.com/Sidhant-Gupta) for the [C++ Implementation](https://github.com/TesseractCoding/NeoAlgo/blob/master/C-Plus-Plus/cryptography/VernamCipher.cpp)
  - [Nidhish Bhimrajka](https://github.com/nidh-ish) for the [Python Implementation](https://github.com/TesseractCoding/NeoAlgo/blob/master/Python/cryptography/Vernam_Cipher.py)
